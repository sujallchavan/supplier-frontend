<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Supplier Signup</title>
    <link rel="stylesheet" href="http://localhost:5000/styles.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <h2>Supplier Signup</h2>
      <form id="signupForm">
        <input type="text" id="name" placeholder="Name" required />
        <input type="email" id="email" placeholder="Email" required />
        <input type="password" id="password" placeholder="Password" required />
        <input type="text" id="category" placeholder="Category" required />
        <input
          type="text"
          id="phoneNumber"
          placeholder="Phone Number"
          required
        />
        <input type="text" id="location" placeholder="Location" required />
        <input
          type="text"
          id="companyName"
          placeholder="company name"
          required
        />
        <button type="submit">Sign Up</button>
      </form>
    </div>

    <!-- ✅ Bootstrap Modal -->
    <div
      class="modal fade"
      id="signupModal"
      tabindex="-1"
      aria-labelledby="modalTitle"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTitle">Signup Status</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body" id="modalMessage"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" id="closeModal">
              OK
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document
        .getElementById("signupForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const name = document.getElementById("name").value;
          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;
          const category = document.getElementById("category").value;
          const companyName = document.getElementById("companyName").value;
          const phoneNumber = document.getElementById("phoneNumber").value;
          const location = document.getElementById("location").value;

          try {
            const response = await fetch(
              "http://localhost:5000/api/suppliers/signup",
              {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                  name,
                  email,
                  password,
                  category,
                  companyName,
                  phoneNumber,
                  location,
                }),
              }
            );

            const result = await response.json();
            document.getElementById("modalMessage").textContent =
              result.message;

            // Show Bootstrap modal
            const modal = new bootstrap.Modal(
              document.getElementById("signupModal")
            );
            modal.show();

            // ✅ Redirect to login page after closing modal
            document
              .getElementById("closeModal")
              .addEventListener("click", () => {
                modal.hide();
                if (response.ok) {
                  window.location.href = "login.html";
                }
              });
          } catch (error) {
            console.error("Signup Error:", error);
            document.getElementById("modalMessage").textContent =
              "Signup failed. Please try again.";

            // Show modal for failure message
            new bootstrap.Modal(document.getElementById("signupModal")).show();
          }
        });
    </script>
  </body>
</html>
